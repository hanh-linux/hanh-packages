# Reference and pre-configured files taken from: Ataraxia Linux
name=wpa_supplicant
ver=2.9
_ver=$ver
desc="A utility providing key negotiation for WPA wireless networks"
home="https://w1.fi/wpa_supplicant/"
license="GPL"
depends="libnl openssl dbus"
sources="https://w1.fi/releases/$name-$_ver.tar.gz \
         https://w1.fi/security/2020-2/0001-P2P-Fix-copying-of-secondary-device-types-for-P2P-gr.patch"
needed="$name-$_ver.tar.gz config 0001-P2P-Fix-copying-of-secondary-device-types-for-P2P-gr.patch config"

unpack-pkg() {
cd $workdir
tar -xf $hanhdir/$name-$ver.tar.gz
cd $name-$ver
patch -Np1 -i $hanhdir/0001-P2P-Fix-copying-of-secondary-device-types-for-P2P-gr.patch
cd $name
}

_config=config

compile-pkg() {
cd $workdir/$name-$_ver/$name
cp -r $hanhdir/$_config .config
make
}

make-pkg() {
cd $workdir/$name-$_ver/$name
make DESTDIR="$pkgdir" install 
install -v -m644 dbus/fi.w1.wpa_supplicant1.service \
                 $pkgdir/usr/share/dbus-1/system-services/ &&
install -v -d -m755 $pkgdir/etc/dbus-1/system.d &&
install -v -m644 dbus/dbus-wpa_supplicant.conf \
                 $pkgdir/etc/dbus-1/system.d/wpa_supplicant.conf
}

